(function(e){function o(o){for(var r,a,s=o[0],c=o[1],d=o[2],u=0,f=[];u<s.length;u++)a=s[u],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&f.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(o);while(f.length)f.shift()();return n.push.apply(n,d||[]),t()}function t(){for(var e,o=0;o<n.length;o++){for(var t=n[o],r=!0,s=1;s<t.length;s++){var c=t[s];0!==i[c]&&(r=!1)}r&&(n.splice(o--,1),e=a(a.s=t[0]))}return e}var r={},i={app:0},n=[];function a(o){if(r[o])return r[o].exports;var t=r[o]={i:o,l:!1,exports:{}};return e[o].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=e,a.c=r,a.d=function(e,o,t){a.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:t})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,o){if(1&o&&(e=a(e)),8&o)return e;if(4&o&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var r in e)a.d(t,r,function(o){return e[o]}.bind(null,r));return t},a.n=function(e){var o=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(o,"a",o),o},a.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=o,s=s.slice();for(var d=0;d<s.length;d++)o(s[d]);var l=c;n.push([0,"chunk-vendors"]),t()})({0:function(e,o,t){e.exports=t("56d7")},"034f":function(e,o,t){"use strict";t("85ec")},2431:function(e,o,t){"use strict";t("9f8a")},"56d7":function(e,o,t){"use strict";t.r(o);t("e260"),t("e6cf"),t("cca6"),t("a79d");var r,i,n,a,s,c,d,l=t("2b0e"),u=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("b-container",{attrs:{id:"app"}},[t("b-toast",{ref:"browser-comp",staticClass:"browser-comp",attrs:{static:"",title:"browser compatibility","no-auto-hide":""}},[e._v(" please use a modern browser to avoid unexpected behavior. ")]),t("div",{staticClass:"canvas-container"},[t("DrawingPad")],1),t("div",{staticClass:"control-container"},[t("Controls")],1)],1)},f=[],m=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",[t("ul",{staticClass:"control-container"},[t("li",[t("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.image-settings-window",modifiers:{"image-settings-window":!0}},{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"image settings"}},[t("i",{staticClass:"fas fa-image"})]),t("ImageSettingsWindow",{on:{submit:e.onImageSettingsWindowSubmit}})],1),t("li",[t("b-form-checkbox-group",{staticClass:"control-button grid-size-container",attrs:{buttons:""}},[t("b-form-checkbox",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{value:"1","unchecked-value":"0",title:"show/hide grid"},on:{change:e.changeShowGridLines},model:{value:e.showGridLines,callback:function(o){e.showGridLines=o},expression:"showGridLines"}},[1==e.showGridLines?[t("i",{staticClass:"fas fa-border-all"})]:[t("i",{staticClass:"fas fa-border-none"})]],2)],1)],1),t("li",[t("b-form-radio-group",{staticClass:"control-button drawmode",attrs:{buttons:""},on:{change:e.chooseDrawMode},model:{value:e.drawMode,callback:function(o){e.drawMode=o},expression:"drawMode"}},[e._l(e.drawModes,(function(e){return[t("b-form-radio",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],key:e.index,attrs:{value:e.value,title:e.text}},[t("i",{class:"fas "+e.icon})])]}))],2)],1),t("li",[t("v-swatches",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{"row-length":"5",title:"color picker"},on:{input:e.chooseColor},model:{value:e.colorToUse,callback:function(o){e.colorToUse=o},expression:"colorToUse"}},[t("b-button",{staticClass:"control-button",attrs:{slot:"trigger"},slot:"trigger"},[t("i",{staticClass:"fas fa-palette"}),t("span",{staticClass:"color-preview",style:"background:"+e.colorToUse})])],1)],1),t("li",[t("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"control-button",attrs:{title:"undo"}},[t("i",{staticClass:"fas fa-undo",on:{click:e.undo}})])],1),t("li",[t("b-dropdown",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"control-button",attrs:{title:"download image"},scopedSlots:e._u([{key:"button-content",fn:function(){return[t("i",{staticClass:"fas fa-file-download"})]},proxy:!0}])},[t("b-dropdown-item",{on:{click:function(o){return e.downloadImage("png")}}},[e._v("PNG")]),t("b-dropdown-item",{on:{click:function(o){return e.downloadImage("jpg")}}},[e._v("JPG")]),t("b-dropdown-item",{on:{click:function(o){return e.downloadImage("gif")}}},[e._v("GIF")])],1)],1)])])},g=[],v=new l["default"],h=v,b=t("7f75"),w=t.n(b),p=(t("b3a4"),function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("b-modal",{attrs:{id:"image-settings-window",title:"image settings"},on:{ok:e.submitModal}},[t("b-form",[t("b-form-group",{attrs:{label:"grid item size"}},[t("b-form-input",{staticClass:"griditemsize",attrs:{type:"number",min:"1",max:"100"},model:{value:e.gridItemSize,callback:function(o){e.gridItemSize=o},expression:"gridItemSize"}})],1),t("b-form-group",{attrs:{label:"grid size"}},[t("b-form-radio-group",{staticClass:"control-button grid-size-container",attrs:{buttons:""},model:{value:e.gridSize,callback:function(o){e.gridSize=o},expression:"gridSize"}},[e._l(e.gridSizes,(function(o){return[t("b-form-radio",{key:o.index,attrs:{value:o.value}},[e._v(" "+e._s(o.name)+" ")])]}))],2)],1)],1)],1)}),S=[],C={name:"ImageSettingsWindow",mounted:function(){var e=this;h.$on("setConfigDefaults",(function(o){e.gridSize=o.gridSize,e.gridItemSize=o.gridItemSize}))},data:function(){return{gridSize:null,gridItemSize:null,gridSizes:[{name:"8x8",value:8},{name:"12x12",value:12},{name:"16x16",value:16},{name:"32x32",value:32},{name:"32x64",value:"32x64"},{name:"64x32",value:"64x32"}]}},methods:{submitModal:function(){var e=this;e.$emit("submit",{gridSize:e.gridSize,gridItemSize:e.gridItemSize})}}},z=C,I=t("2877"),x=Object(I["a"])(z,p,S,!1,null,null,null),_=x.exports,k={name:"Controls",components:{VSwatches:w.a,ImageSettingsWindow:_},mounted:function(){var e=this;h.$on("setConfigDefaults",(function(o){e.gridSize=o.gridSize,e.colorToUse=o.colorToUse,e.drawMode=o.drawMode,e.showGridLines=o.showGridLines?"1":"0",e.gridItemSize=o.gridItemSize}))},data:function(){return{gridSize:null,colorToUse:null,drawMode:null,showGridLines:null,gridItemSize:null,drawModes:[{value:"floodfill",text:"Floodfill",icon:"fa-fill-drip fa-flip-horizontal"},{value:"simple",text:"Pencil",icon:"fa-pencil-alt"},{value:"line",text:"Line",icon:"fa-pencil-ruler"},{value:"erase",text:"Eraser",icon:"fa-eraser"},{value:"flooderase",text:"FloodEraser",icon:"fa-fill-drip"}],gridSizes:[{name:"8x8",value:8},{name:"12x12",value:12},{name:"16x16",value:16},{name:"32x32",value:32}]}},methods:{onImageSettingsWindowSubmit:function(e){var o=this;o.changeGridItemSize(e.gridItemSize),o.chooseGridSize(e.gridSize)},undo:function(){h.$emit("undo")},changeGridItemSize:function(e){h.$emit("changeGridItemSize",parseInt(e))},changeShowGridLines:function(e){h.$emit("changeShowGridLines",e+""==="1")},chooseColor:function(e){h.$emit("changeColor",e),this.colorToUse=e},chooseDrawMode:function(e){h.$emit("changeDrawMode",e)},chooseGridSize:function(e){this.gridSize=e,h.$emit("changeGridSize",e)},downloadImage:function(e){h.$emit("downloadImage",e)}}},G=k,y=Object(I["a"])(G,m,g,!1,null,null,null),M=y.exports,T=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"inner"},[t("canvas",{ref:"canvas",attrs:{width:"0",height:"0"}})])},L=[],E=(t("cb29"),t("1276"),t("ac1f"),t("aeb1")),D=t.n(E),$={},P={},O=null,X=[],Y=function(){var e=0,o=0;$={};for(var t=0;t<c*d;t++)e>=c&&(e=0,o++),$[e+":"+o]={index:t,bgcolor:n,bordercolor:a,coordX:e,coordY:o},e++;X.push(F())},j=function(){var e=O.getContext("2d");for(var o in e.clearRect(0,0,O.width,O.height),$){var t=$[o],r=t.coordX*i,n=t.coordY*i;t.posX=r,t.posY=n,e.beginPath(),e.moveTo(r,n),e.lineTo(r+i,n),e.lineTo(r+i,n+i),e.lineTo(r,n+i),e.lineTo(r,n),e.closePath(),e.fillStyle=t.bgcolor,e.fill()}if(s){for(var a=1;a*i<O.height;a++){var c=i*a;c=Math.floor(c)+.5,e.beginPath(),e.moveTo(0,c),e.lineTo(O.width,c),e.lineTo(0,c),e.closePath(),e.lineWidth=1,e.strokeStyle=t.bordercolor,e.stroke()}for(var d=1;d*i<O.width;d++){var l=i*d;l=Math.floor(l)+.5,e.beginPath(),e.moveTo(l,0),e.lineTo(l,O.height),e.lineTo(l,0),e.closePath(),e.lineWidth=1,e.strokeStyle=t.bordercolor,e.stroke()}}};function U(e,o,t){if(t.bgcolor!==e){t.bgcolor===o&&(t.bgcolor=e);for(var r=t.coordX,i=t.coordY,n=[[r-1+":"+i],[r-1+":"+(i-1)],[r+":"+(i-1)],[r+1+":"+(i-1)],[r+1+":"+i],[r+1+":"+(i+1)],[r+":"+(i+1)],[r-1+":"+(i+1)]],a=0;a<n.length;a++){var s=$[n[a]];s&&s.bgcolor===o&&U(e,o,s)}}}function N(e,o,t){for(var r in P)$[r].bgcolor=P[r].bgcolor;var i=o.coordX,n=o.coordY,a=t.coordX,s=t.coordY,c=Math.abs(a-i),d=i<a?1:-1,l=-1*Math.abs(s-n),u=n<s?1:-1,f=c+l,m=!0;while(m){if($[i+":"+n].bgcolor=e,i==a&&n==s)break;var g=2*f;g>=l&&(f+=l,i+=d),g<=c&&(f+=c,n+=u)}}var F=function(){return JSON.parse(JSON.stringify($))},B=function(e,o){for(var t in $){var r=$[t];if(r.posX<e+1&&r.posX+i>e-1&&r.posY<o+1&&r.posY+i>o-1)return r}return null},W=function(e){var o=O.getBoundingClientRect(),t=o.left,r=o.top;return B(e.clientX-t,e.clientY-r)},H=function(e,o){D()(O.toDataURL("image/"+o),e+"."+o,"image/"+o)},J=function(e){s=e,j()},V=function(e){i=e,q(r),j()},R=function(e,o,t){var r=!0,i=t.current;switch(e){case"simple":i.bgcolor===o?r=!1:i.bgcolor=o;break;case"erase":i.bgcolor="#ffffff00";break;case"floodfill":U(o,i.bgcolor,i);break;case"flooderase":U("#ffffff00",i.bgcolor,i);break;case"line":N(o,t.start,i);break;default:console.warn("unbekannter drawmode "+e)}r&&j()},A=function(){P=F()},q=function(e){if(r=e,"string"===typeof r){var o=r.split("x");c=o[0],d=o[1]}else c=e,d=e;O.width=c*i,O.height=d*i,Y(),j()},K=function(){var e=X.pop();e&&($=e,j())},Q=function(){X.push(F())},Z=function(e,o){O=e,r=o.gridSize,i=o.gridItemSize,n=o.gridItemDefaultBgColor,a=o.gridItemDefaultBorderColor,s=o.gridItemBorderVisible,c=o.gridItemsHorizontal,d=o.gridItemsVertical},ee={init:Z,setGridSize:q,cacheGridMap:A,getGridItemFromPosition:B,getGridItemFromEvent:W,applyDrawMode:R,downloadImage:H,showGridLines:J,changeGridItemSize:V,undo:K,updateHistory:Q},oe=t("53ca"),te={_cursor:null,_currentCursor:null,initCursor:function(){var e=this;e._cursor=document.createElement("div"),e._cursor.className="cursor",e._cursor.hidden=!0,document.body.appendChild(e._cursor)},addCursorChanger:function(e,o){var t=this;e.addEventListener("mousemove",(function(e){if(t._cursor&&e&&!e.noPropagationForCursor){e.noPropagationForCursor=!0,t._cursor.hidden=!0;var r=o();if(!r)return;var i=r.text;"hide"===r?t._cursor.classList.contains("kaku-hide-cursor")||t._cursor.classList.add("kaku-hide-cursor"):t._cursor.classList.remove("kaku-hide-cursor"),"object"===Object(oe["a"])(r)&&(t._currentCursor=r),t._cursor.hidden=!1,t._cursor.style.top=e.clientY+(t._currentCursor.offsetY?t._currentCursor.offsetY:0)+"px",t._cursor.style.left=e.clientX+(t._currentCursor.offsetX?t._currentCursor.offsetX:0)+"px",i&&(t._cursor.innerHTML=i)}})),e.addEventListener("mouseout",(function(){t._cursor.hidden=!0}))},update:function(e){e.dispatchEvent(new Event("mousemove"))}},re=(t("b0c0"),t("337f")),ie=t.n(re),ne=t("8df8"),ae=t.n(ne),se=ie.a.getParser(window.navigator.userAgent),ce={browserIsCompatible:function(){var e=!0,o=se.getBrowser();return"Internet Explorer"===o.name&&"11.0"!==o.version&&(e=!1),e},isTouchDevice:function(){return ae()()},getCursorEvent:function(e){var o=this,t=e;return o.isTouchDevice()&&(t=e.touches[0],t||(t=e.changedTouches[0])),t}},de={name:"DrawingPad",created:function(){this.drawStartGridItem=null},mounted:function(){var e=this;ce.isTouchDevice()?e.$refs.canvas.addEventListener("touchstart",e.initDraw):e.$refs.canvas.addEventListener("mousedown",e.initDraw),h.$on("setConfigDefaults",(function(o){ee.init(e.$refs.canvas,o),ee.setGridSize(o.gridSize),e.gridSize=o.gridSize,e.colorToUse=o.colorToUse,e.drawMode=o.drawMode,e.showGridLines=o.showGridLines,e.gridItemSize=o.gridItemSize})),te.addCursorChanger(e.$refs.canvas,(function(){return"hide"})),h.$on("changeColor",(function(o){e.colorToUse=o})),h.$on("changeDrawMode",(function(o){e.drawMode=o})),h.$on("changeGridSize",(function(o){e.gridSize=o,ee.setGridSize(o)})),h.$on("downloadImage",(function(e){ee.downloadImage("kaku_img",e)})),h.$on("changeShowGridLines",(function(e){ee.showGridLines(!!e)})),h.$on("changeGridItemSize",(function(e){ee.changeGridItemSize(e)})),h.$on("undo",(function(){ee.undo()}))},methods:{draw:function(e){var o=this,t=ee.getGridItemFromEvent(e);t&&ee.applyDrawMode(o.drawMode,o.colorToUse,{current:t,start:o.drawStartGridItem})},initDraw:function(e){var o=this;if(ce.isTouchDevice()||1===e.which){ee.cacheGridMap(),ee.updateHistory();var t=o.getCursorEvent(e);o.drawStartGridItem=ee.getGridItemFromEvent(t);var r=function e(t){var r=o.getCursorEvent(t);ce.isTouchDevice()?(window.removeEventListener("touchend",e),window.removeEventListener("touchmove",i)):(window.removeEventListener("mouseup",e),window.removeEventListener("mousemove",i)),o.draw(r),o.drawStartGridItem=null},i=function(e){var t=o.getCursorEvent(e);o.draw(t)};ce.isTouchDevice()?(window.addEventListener("touchend",r),window.addEventListener("touchmove",i)):(window.addEventListener("mouseup",r),window.addEventListener("mousemove",i))}},getCursorEvent:function(e){var o=ce.getCursorEvent(e);return o}}},le=de,ue=(t("2431"),Object(I["a"])(le,T,L,!1,null,"51106562",null)),fe=ue.exports,me={defaults:{gridSize:8,colorToUse:"#27AF60",drawMode:"line",showGridLines:!0,gridItemSize:8,gridItemDefaultBgColor:"#ffffff00",gridItemDefaultBorderColor:"#666",gridItemBorderVisible:!0,gridItemsHorizontal:10,gridItemsVertical:10}},ge={name:"kaku",components:{Controls:M,DrawingPad:fe},mounted:function(){var e=this;ce.isTouchDevice()||e.initCursor(),ce.isTouchDevice()&&document.body.classList.add("kaku-is-mobile"),h.$emit("setConfigDefaults",me.defaults),ce.browserIsCompatible()||e.$refs["browser-comp"].show()},methods:{initCursor:function(){var e=this;e._drawMode=me.defaults.drawMode,te.initCursor(),te.addCursorChanger(document.body,(function(){switch(e._drawMode){case"simple":return{offsetX:15,offsetY:15,text:'<i class="fas fa-pencil-alt"></i>'};case"line":return{offsetX:15,offsetY:15,text:'<i class="fas fa-pencil-ruler"></i>'};case"floodfill":return{offsetX:15,offsetY:15,text:'<i class="fas fa-fill-drip fa-flip-horizontal"></i>'};case"erase":return{offsetX:15,offsetY:15,text:'<i class="fas fa-eraser"></i>'};case"flooderase":return{offsetX:15,offsetY:15,text:'<i class="fas fa-fill-drip"></i>'}}})),h.$on("changeDrawMode",(function(o){e._drawMode=o,te.update(document.body)}))}}},ve=ge,he=(t("034f"),Object(I["a"])(ve,u,f,!1,null,null,null)),be=he.exports,we=t("5f5b");t("ab8b"),t("2dd8"),t("becf");l["default"].use(we["a"]),new l["default"]({render:function(e){return e(be)}}).$mount("#app")},"85ec":function(e,o,t){},"9f8a":function(e,o,t){}});
//# sourceMappingURL=app.091169ab.js.map